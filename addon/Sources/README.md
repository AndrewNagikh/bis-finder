# Модульная структура источников данных BiSFinder

## Обзор

BiSFinder теперь использует модульную архитектуру для поддержки множественных источников данных. Каждый источник данных (например, IcyVeins, Archon) является отдельным модулем со своей логикой и данными.

## Структура папок

```
Sources/
├── SourceManager.lua          # Менеджер источников данных
├── IcyVeins/                  # Модуль IcyVeins
│   ├── IcyVeinsData.lua       # Данные предметов IcyVeins
│   ├── ClassSpecMapping.lua   # Маппинг классов/специализаций IcyVeins
│   └── IcyVeinsModule.lua     # Основной модуль IcyVeins
└── Archon/                    # Будущий модуль Archon
    ├── ArchonData.lua
    ├── ClassSpecMapping.lua   # Маппинг классов/специализаций Archon
    └── ArchonModule.lua
```

## Компоненты модуля

### 1. SourceManager.lua
Центральный менеджер, который:
- Регистрирует все доступные источники данных
- Управляет переключением между источниками
- Предоставляет единый API для работы с данными

### 2. Модуль источника (например, IcyVeinsModule.lua)
Основной файл модуля, который должен содержать:
- `name` - уникальное имя модуля
- `displayName` - отображаемое имя
- `Initialize()` - инициализация модуля
- `GetItemsForSpec(specName)` - получение предметов для специализации
- `RenderItems(parent, specName, x, y)` - рендеринг предметов
- `GetInfo()` - информация о модуле

### 3. Данные модуля (например, IcyVeinsData.lua)
Файл с данными предметов в формате, специфичном для источника.

### 4. Маппинг классов (например, ClassSpecMapping.lua)
Файл с маппингом классов и специализаций для конкретного источника. Каждый источник имеет свой собственный маппинг, так как структура данных может отличаться.

## Добавление нового источника

1. Создайте папку `Sources/YourSource/`
2. Создайте файлы:
   - `YourSourceModule.lua` - основной модуль
   - `YourSourceData.lua` - данные предметов
   - `ClassSpecMapping.lua` - маппинг классов
3. Добавьте файлы в `BiSFinder.toc`
4. Зарегистрируйте модуль в `BiSFinder.lua`

## API модуля

### Обязательные методы:
```lua
function Module:Initialize()
    -- Инициализация модуля
end

function Module:GetItemsForSpec(specName)
    -- Возвращает предметы для специализации
end

function Module:RenderItems(parent, specName, x, y)
    -- Рендерит предметы в UI
    -- Возвращает массив созданных элементов
end

function Module:GetInfo()
    -- Возвращает информацию о модуле
    return {
        name = self.name,
        displayName = self.displayName,
        itemCount = self:GetItemCount(),
        version = "1.0"
    }
end
```

### Опциональные методы:
```lua
function Module:GetItemCount()
    -- Возвращает количество предметов в базе
end
```

## Переиспользуемые компоненты

- **ClassButtons.lua** - кнопки специализаций (общие для всех модулей)
- **UIElements.lua** - UI элементы (общие для всех модулей)
- **SourceMenu.lua** - боковое меню (автоматически адаптируется к модулям)

## Преимущества модульной архитектуры

1. **Изоляция данных** - каждый источник имеет свои данные и логику
2. **Легкое добавление** - новые источники добавляются без изменения основного кода
3. **Переиспользование** - общие компоненты используются всеми модулями
4. **Масштабируемость** - легко поддерживать множество источников
5. **Тестируемость** - каждый модуль можно тестировать независимо
